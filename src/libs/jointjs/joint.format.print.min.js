/*! Rappid v2.3.0 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2015 client IO

 2018-07-22 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


!function(a,b,c){var d=200,e=200;c.dia.Paper.prototype.print=function(b){var c,d=j(b),e=m.call(this,d),f=[],g=a(document.body);if(d.poster)for(var h=o(e,d.poster),i=n(e,h),k=0;k<i.length;k++)c=this.preparePrintArea(i[k],d),f.push(c.$el);else c=this.preparePrintArea(e,d),f.push(c.$el);c&&l(c.css,d),d.ready(f,function(c){if(c){g.addClass("joint-print");var d=this.$el.children().detach();c.forEach(function(a){a.removeClass("preview").addClass("print-ready"),a.prependTo(document.body)});var e=!1,f=function(){e||(e=!0,g.removeClass("joint-print"),c.forEach(function(a){a.remove()}),this.$el.append(d),this.trigger("afterprint",b),a(window).off("afterprint",f))}.bind(this);a(window).one("afterprint",f),setTimeout(f,200),window.print()}}.bind(this))},c.dia.Paper.prototype.preparePrintArea=function(c,d){this.trigger("beforeprint",d);var e=a("<div/>").addClass("printarea");d.size&&e.addClass("printarea-size-"+d.size);var f=this.scale();this.scale(1);var g=this.$el.clone().appendTo(e),h=i(this.getArea(),c,d),j=h.rect,k=h.scaleToFit;g.css({left:0,top:0,width:"200%",height:"200%"}),b(g.find("svg")[0]).attr({width:j.width,height:j.height,viewBox:[j.x,j.y,j.width,j.height].join(" ")});var l=this.options.gridSize;if(l>1){var m=e.find(".joint-paper-grid");m.css({transform:["translate(",-j.x%l,"px, ",-j.y%l,"px)"].join("")})}return this.scale(f.sx,f.sy),e.addClass("preview"),{$el:e,css:{width:j.width+"px",height:j.height+"px",transform:"scale("+k+")","transform-origin":"0 0"}}};var f=function(a){return Object.keys(a).map(function(b){return b+":"+a[b]}).join(";")+";"},h=function(a,b){var c=p.toPx(b.left+b.right,b.unit),d=p.toPx(b.top+b.bottom,b.unit);return{width:Math.max(p.toPx(a.width,a.unit)-c,1),height:Math.max(p.toPx(a.height,a.unit)-d,1)}},i=function(a,b,d){var e=g.Rect({x:b.x-a.x,y:b.y-a.y,width:b.width,height:b.height}),f=c.util.normalizeSides(d.margin),i=d.sheet;f.unit=d.marginUnit,i.unit=d.sheetUnit;var j,k=h(i,f),l=e.width/e.height,m=k.width/k.height;return j=l>m?k.width/e.width:k.height/e.height,{rect:e,scaleToFit:j}},j=function(a){var b=c.util.defaultsDeep({},a,{area:null,poster:!1,sheet:{width:210,height:297},sheetUnit:"mm",ready:function(a,b){b(a)},margin:.4,marginUnit:"in",padding:5});return b.area||(b.printingAll=!0),b},k=function(b){var c=a("#print-styles"),d='<style type="text/css" id="print-styles">'+b+"</style>";c.length?c.html(b):a("head").append(d)},l=function(a,b){var d=f(a),e=c.util.normalizeSides(b.margin),g=b.marginUnit,h=[e.top+g,e.right+g,e.bottom+g,e.left+g].join(" "),i=b.sheet.width>b.sheet.height?"landscape":"portrait",j=["@media print {",".printarea.print-ready {",d,"}","@page {","margin:"+h+";","size:"+i+";","}","}",".printarea.preview {",d,"}"];k(j.join(""))},m=function(a){var b=a.area;if(!b){var d=c.util.normalizeSides(a.padding);b=this.getContentArea().moveAndExpand({x:-d.left,y:-d.top,width:d.left+d.right,height:d.top+d.bottom})}return b},n=function(a,b){for(var c,f=b.width,h=b.height,i=[],j=0,k=0,l=0,m=0;j<a.height;){for(;k<a.width&&(c=g.Rect(a.x+k,a.y+j,f,h),i.push(c),k+=f,!(m>e));)m++;if(k=0,m=0,j+=h,l>d)break;l++}return i.reverse()},o=function(a,b){var c={width:b.width,height:b.height};return c.width||(c.width=Math.ceil(a.width/(b.columns||1))),c.height||(c.height=Math.ceil(a.height/(b.rows||1))),c},p={supportedUnits:{px:function(a){return a},mm:function(a){return this.millimeterSize*a},cm:function(a){return this.millimeterSize*a*10},"in":function(a){return this.millimeterSize*a*25.4},pt:function(a){return this.millimeterSize*(25.4*a/72)},pc:function(a){return this.millimeterSize*(25.4*a/6)}},measureMillimeter:function(){var b=a("<div/>").css({display:"inline-block",position:"absolute",left:-5e3,width:"1mm",height:"1mm"}).appendTo(document.body),c=b.width();return b.remove(),c},toPx:function(a,b){if(this.millimeterSize||(this.millimeterSize=this.measureMillimeter()),b=(b||"").toLowerCase(),!this.supportedUnits[b])throw new Error("Unsupportted unit "+b);return this.supportedUnits[b].call(this,a)}}}($,V,joint);